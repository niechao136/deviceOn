app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: DeviceOn å·¥ä½œæµ é€»è¾‘æ‹†åˆ†
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/ollama:0.0.3@9ded90ac00e8510119a24be7396ba77191c9610d5e1e29f59d68fa1229822fc7
kind: app
version: 0.1.5
workflow:
  conversation_variables:
  - description: ç¼“å­˜ç±»å‹
    id: 65615826-d819-468b-b4d4-fe6c1679a448
    name: cache_type
    selector:
    - conversation
    - cache_type
    value: ''
    value_type: string
  - description: ç¼“å­˜å†…å®¹
    id: 526c8778-80d7-4100-8df9-954f6e7a8a7d
    name: cache_content
    selector:
    - conversation
    - cache_content
    value: ''
    value_type: string
  environment_variables:
  - description: ''
    id: 1259af35-f28b-4964-83cb-a74de8dc7e69
    name: ota
    selector:
    - env
    - ota
    value: app-XZlBP7u0m0JSm485uYKYHeu1
    value_type: string
  - description: ''
    id: de9e36a2-b72c-4b04-a5bb-75b6d15124a9
    name: user_reply
    selector:
    - env
    - user_reply
    value: app-QDKEagg7OujpojWVvPaG7suZ
    value_type: string
  - description: ''
    id: 5538d734-824b-41ee-ae69-52826d02fe2a
    name: other
    selector:
    - env
    - other
    value: app-qGW55Y3WAy5urBkHZTRhMOmY
    value_type: string
  - description: ''
    id: 45cc85dd-4125-4847-bbe6-2ca59b2cabde
    name: remote_desktop
    selector:
    - env
    - remote_desktop
    value: app-572m5unmOrUAIkiHLQTIgcay
    value_type: string
  - description: ''
    id: ef2c77fc-28a3-4d2c-be42-f91ee4f20b17
    name: device_control
    selector:
    - env
    - device_control
    value: app-q6Fb44URXirNCeYQmm3lQko0
    value_type: string
  - description: ''
    id: 22dbbf82-11a1-451a-ad4f-aaeb4a1baa45
    name: filter_device
    selector:
    - env
    - filter_device
    value: app-Xvq7Qhc5XuMqV1op7yUIzHxx
    value_type: string
  - description: ''
    id: b6d78f8e-fe29-4ce7-92b4-b31922045920
    name: path
    selector:
    - env
    - path
    value: http://172.21.161.126/v1/workflows/run
    value_type: string
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      auto_submit:
        enabled: false
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: assigner
        targetType: answer
      id: 1743564155266-source-1741157785828-target
      source: '1743564155266'
      sourceHandle: source
      target: '1741157785828'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: assigner
      id: 1743575162350-false-1743564155266-target
      source: '1743575162350'
      sourceHandle: 'false'
      target: '1743564155266'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1743575162350-true-1743575197314-target
      source: '1743575162350'
      sourceHandle: 'true'
      target: '1743575197314'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1743575197314-source-1743575286019-target
      source: '1743575197314'
      sourceHandle: source
      target: '1743575286019'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: assigner
      id: 1743575286019-source-17435753774250-target
      source: '1743575286019'
      sourceHandle: source
      target: '17435753774250'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: assigner
        targetType: answer
      id: 17435753774250-source-1743575387750-target
      source: '17435753774250'
      sourceHandle: source
      target: '1743575387750'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: code
      id: 1741065173647-source-1743665972900-target
      source: '1741065173647'
      sourceHandle: source
      target: '1743665972900'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: http-request
      id: 1743665972900-source-1743665976785-target
      source: '1743665972900'
      sourceHandle: source
      target: '1743665976785'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: http-request
        targetType: code
      id: 1743665976785-source-1743665979987-target
      source: '1743665976785'
      sourceHandle: source
      target: '1743665979987'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 1743665979987-source-1743666463997-target
      source: '1743665979987'
      sourceHandle: source
      target: '1743666463997'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: assigner
        targetType: if-else
      id: 1743666463997-source-1743666382237-target
      source: '1743666463997'
      sourceHandle: source
      target: '1743666382237'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 1743666382237-false-1743666436043-target
      source: '1743666382237'
      sourceHandle: 'false'
      target: '1743666436043'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1743666382237-true-1744013407466-target
      source: '1743666382237'
      sourceHandle: 'true'
      target: '1744013407466'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1744013407466-source-1744013620630-target
      source: '1744013407466'
      sourceHandle: source
      target: '1744013620630'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: http-request
      id: 1744013620630-source-1744019507038-target
      source: '1744013620630'
      sourceHandle: source
      target: '1744019507038'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: http-request
        targetType: code
      id: 1744019507038-source-1744020229740-target
      source: '1744019507038'
      sourceHandle: source
      target: '1744020229740'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1744020229740-source-1743575162350-target
      source: '1744020229740'
      sourceHandle: source
      target: '1743575162350'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: api
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: api
        - label: token
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: token
        - label: timezone
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: timezone
      height: 142
      id: '1741065173647'
      position:
        x: 30
        y: 271
      positionAbsolute:
        x: 30
        y: 271
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1744020229740.result#}}'
        desc: ''
        selected: false
        title: å›å¤å·¥ä½œæµç»“æœ
        type: answer
        variables: []
      height: 105
      id: '1741157785828'
      position:
        x: 3678
        y: 408.5
      positionAbsolute:
        x: 3678
        y: 408.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1744020229740'
          - type
          variable_selector:
          - conversation
          - cache_type
          write_mode: over-write
        - input_type: variable
          operation: over-write
          value:
          - '1744020229740'
          - content
          variable_selector:
          - conversation
          - cache_content
          write_mode: over-write
        selected: false
        title: å¤„ç†ç¼“å­˜
        type: assigner
        version: '2'
      height: 116
      id: '1743564155266'
      position:
        x: 3374
        y: 408.5
      positionAbsolute:
        x: 3374
        y: 408.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: e9938b28-5178-4e22-88a7-30759b109218
            value: '1'
            varType: number
            variable_selector:
            - '1744020229740'
            - need_answer
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: åˆ¤æ–­æ˜¯å¦é€šè¿‡ LLM å›ç­”
        type: if-else
      height: 126
      id: '1743575162350'
      position:
        x: 3070
        y: 408.5
      positionAbsolute:
        x: 3070
        y: 408.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - sys
          - query
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 50
        model:
          completion_params:
            num_ctx: 32768
            temperature: 0
          mode: chat
          name: deepseek-r1:14b
          provider: langgenius/ollama/ollama
        prompt_template:
        - id: e4d8dd2a-01d4-4858-beaa-89f4c50580dd
          role: system
          text: "# é—®é¢˜å›ç­”æŒ‡ä»¤\n\n**è¦æ±‚æ¨¡å‹ï¼š**\n1. é¦–å…ˆæ£€æŸ¥å½“å‰ä¼šè¯çš„è®°å¿†ä¸Šä¸‹æ–‡ï¼š\n    - **è‹¥ä¸Šä¸‹æ–‡èƒ½å›ç­”é—®é¢˜**ï¼Œè¯·ç»“åˆä¸Šä¸‹æ–‡ç”Ÿæˆå›ç­”ï¼›\n\
            \    - **è‹¥ä¸Šä¸‹æ–‡ä¸è¶³**ï¼Œè¯·åŸºäºé—®é¢˜æœ¬èº«ç»™å‡ºå›ç­”ï¼Œå¹¶æä¾›ç›¸åº”å»ºè®®ï¼Œä»¥å¸®åŠ©ç”¨æˆ·è·å¾—æ›´å¤šä¿¡æ¯æˆ–å¯å‘æ€è·¯ã€‚\n2. å›ç­”æ—¶ï¼š\n   \
            \ - ä¿æŒä¸é—®é¢˜è¯­è¨€ä¸€è‡´ï¼›\n    - ä½¿ç”¨æ¸…æ™°ã€ç®€æ´çš„è¡¨è¿°ï¼›\n    - ç»“æ„åŒ–å‘ˆç°æ ¸å¿ƒä¿¡æ¯ï¼ˆå¯åˆ†ç‚¹è¯´æ˜ï¼‰ï¼›\n    - é¿å…å†—ä½™ä¿®é¥°å’Œå¤æ‚å¥å¼ï¼›\n\
            3. ç¦æ­¢ç¼–é€ æˆ–æ¨æµ‹ç­”æ¡ˆã€‚\n\n## é—®é¢˜\n{{#context#}}"
        - id: 8a5316aa-fdf8-42f4-808e-7fbb4e787f84
          role: user
          text: '{{#context#}}'
        selected: false
        title: LLM ç›´æ¥å›ç­”
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1743575197314'
      position:
        x: 3374
        y: 564.5
      positionAbsolute:
        x: 3374
        y: 564.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "/**\n * å¤„ç† LLM å›ç­”\n */\nfunction main({text}) {\n  return {\n    result:\
          \ String(text).replaceAll(/<think>[\\s\\S]*?<\\/think>/g, '').replaceAll(/<details[\\\
          s\\S]*?<\\/details>/g, ''),\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: å¤„ç† LLM å›ç­”
        type: code
        variables:
        - value_selector:
          - '1743575197314'
          - text
          variable: text
      height: 54
      id: '1743575286019'
      position:
        x: 3678
        y: 577
      positionAbsolute:
        x: 3678
        y: 577
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: clear
          value: ''
          variable_selector:
          - conversation
          - cache_type
          write_mode: over-write
        - input_type: variable
          operation: clear
          value: ''
          variable_selector:
          - conversation
          - cache_content
          write_mode: over-write
        selected: false
        title: å¤„ç†ç¼“å­˜
        type: assigner
        version: '2'
      height: 116
      id: '17435753774250'
      position:
        x: 3982
        y: 551.5
      positionAbsolute:
        x: 3982
        y: 551.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1743575286019.result#}}'
        desc: ''
        selected: false
        title: å›å¤ç›´æ¥å›ç­”
        type: answer
        variables: []
      height: 105
      id: '1743575387750'
      position:
        x: 4286
        y: 551.5
      positionAbsolute:
        x: 4286
        y: 551.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "/**\n * ç”¨æˆ·å›å¤ Request\n */\nfunction main({cache_type, cache_content,\
          \ query, timezone, api, token}) {\n  return {\n    request: JSON.stringify({\n\
          \      inputs: {\n        content: cache_content,\n        type: cache_type,\n\
          \        question: query,\n        timezone,\n        api,\n        token\n\
          \      },\n      response_mode: 'blocking',\n      user: 'deviceOn'\n  \
          \  })\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          request:
            children: null
            type: string
        selected: false
        title: ç”¨æˆ·å›å¤ Request
        type: code
        variables:
        - value_selector:
          - '1741065173647'
          - api
          variable: api
        - value_selector:
          - '1741065173647'
          - token
          variable: token
        - value_selector:
          - '1741065173647'
          - timezone
          variable: timezone
        - value_selector:
          - sys
          - query
          variable: query
        - value_selector:
          - conversation
          - cache_type
          variable: cache_type
        - value_selector:
          - conversation
          - cache_content
          variable: cache_content
      height: 54
      id: '1743665972900'
      position:
        x: 334
        y: 271
      positionAbsolute:
        x: 334
        y: 271
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-29
            key: ''
            type: text
            value: '{{#1743665972900.request#}}'
          type: json
        desc: ''
        headers: 'Authorization:Bearer {{#env.user_reply#}}

          Content-Type:application/json'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: ç”¨æˆ·å›å¤
        type: http-request
        url: '{{#env.path#}}'
        variables: []
      height: 123
      id: '1743665976785'
      position:
        x: 638
        y: 271
      positionAbsolute:
        x: 638
        y: 271
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "/**\n * å¤„ç†ç”¨æˆ·å›å¤\n */\nfunction main({body}) {\n  const obj = JSON.parse(body)\n\
          \  const outputs = obj?.data?.outputs ?? {}\n  return {\n    result: outputs?.result\
          \ ?? '',\n    content: outputs?.content ?? '',\n    type: outputs?.type\
          \ ?? '',\n    answer: Number(outputs?.answer ?? 0)\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          answer:
            children: null
            type: number
          content:
            children: null
            type: string
          result:
            children: null
            type: string
          type:
            children: null
            type: string
        selected: false
        title: å¤„ç†ç”¨æˆ·å›å¤
        type: code
        variables:
        - value_selector:
          - '1743665976785'
          - body
          variable: body
      height: 54
      id: '1743665979987'
      position:
        x: 942
        y: 271
      positionAbsolute:
        x: 942
        y: 271
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: b2fdcd53-04aa-4860-9c0f-a9d434a2beed
            value: '0'
            varType: number
            variable_selector:
            - '1743665979987'
            - answer
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: åˆ¤æ–­æ˜¯å¦ç›´æ¥å›å¤
        type: if-else
      height: 126
      id: '1743666382237'
      position:
        x: 1550
        y: 271
      positionAbsolute:
        x: 1550
        y: 271
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1743665979987.result#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 105
      id: '1743666436043'
      position:
        x: 1854
        y: 271
      positionAbsolute:
        x: 1854
        y: 271
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1743665979987'
          - type
          variable_selector:
          - conversation
          - cache_type
          write_mode: over-write
        - input_type: variable
          operation: over-write
          value:
          - '1743665979987'
          - content
          variable_selector:
          - conversation
          - cache_content
          write_mode: over-write
        selected: false
        title: å¤„ç†ç¼“å­˜
        type: assigner
        version: '2'
      height: 116
      id: '1743666463997'
      position:
        x: 1246
        y: 271
      positionAbsolute:
        x: 1246
        y: 271
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - sys
          - query
        desc: ''
        model:
          completion_params:
            num_ctx: 32768
            temperature: 0
          mode: chat
          name: deepseek-r1:14b
          provider: langgenius/ollama/ollama
        prompt_template:
        - id: 209a9fb2-79e6-4de9-872d-6fb2020928ec
          role: system
          text: "# é—®é¢˜åˆ†ç±»æŒ‡ä»¤\n\nè¯·æ ¹æ®ä»¥ä¸‹åˆ†ç±»æ ‡å‡†å¯¹`{{#context#}}`è¿›è¡Œåˆ†ç±»ï¼š\n\n**1. è®¾å¤‡æ§åˆ¶ç±»**\n- å…³é”®è¯ï¼šè®¾å¤‡é‡å¯ã€å…³æœºã€è°ƒèŠ‚éŸ³é‡ã€è°ƒèŠ‚äº®åº¦ã€é™éŸ³\n\
            - ç¤ºä¾‹ï¼šå…³é—­è®¾å¤‡ã€éŸ³é‡è°ƒä½ã€å¼€å¯é™éŸ³æ¨¡å¼\n\n**2. è¿œç¨‹æ¡Œé¢ç±»**\n- å…³é”®è¯ï¼šè¿æ¥ã€è¿œç¨‹è¿æ¥ã€è¿œç¨‹æ¡Œé¢ã€è¿œç¨‹æ“ä½œã€è¿œç¨‹è®¿é—®\n\
            - ç¤ºä¾‹ï¼šè¿æ¥åˆ°å¦ä¸€å°ç”µè„‘ã€å‘èµ·è¿œç¨‹ååŠ©ã€è¿œç¨‹æ§åˆ¶è®¾å¤‡\n\n**3. è®¾å¤‡æŸ¥æ‰¾ç±»**\n- å…³é”®è¯ï¼šæ ¹æ®è®¾å¤‡çš„ID/åç§°/ç³»ç»Ÿ/IP/æ ‡ç­¾/åœ¨çº¿çŠ¶æ€/å¼‚å¸¸çŠ¶æ€æ¥æŸ¥æ‰¾ã€æ‰¾å‡ºã€åˆ—å‡ºã€æ˜¾ç¤ºã€æ£€ç´¢ã€æŸ¥çœ‹ã€æ£€æŸ¥è®¾å¤‡\n\
            - ç¤ºä¾‹ï¼šæ‰¾IPä¸º192.168.1.1çš„è®¾å¤‡ã€åˆ—å‡ºæ‰€æœ‰å¼‚å¸¸è®¾å¤‡\n\n**4. è¿œç¨‹æ›´æ–°ç±»**\n- å…³é”®è¯ï¼šç³»ç»Ÿ/è½¯ä»¶æ›´æ–°ã€å‡çº§ã€å®‰è£…ã€æ‰“è¡¥ä¸\n\
            - ç¤ºä¾‹ï¼šå®‰è£…æœ€æ–°è¡¥ä¸ã€å‡çº§åˆ°v2.0ç‰ˆæœ¬\n\n**5. å…¶ä»–ç±»**\n- æ¡ä»¶ï¼šæ— æ³•åŒ¹é…ä¸Šè¿°ä»»ä½•åˆ†ç±»çš„è¯·æ±‚\n\n**è¾“å‡ºè¦æ±‚**\n\
            ```json\n{\n  \"classify\": \"<æ•°å­—ï¼Œåˆ†ç±»ç¼–å·ï¼š1 | 2 | 3 | 4 | 5>\",\n  \"reason\"\
            : \"<ä¸è¶…è¿‡15å­—çš„å…³é”®è¯ä¾æ®>\"\n}\n```\n"
        selected: false
        title: LLM é—®é¢˜åˆ†ç±»
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1744013407466'
      position:
        x: 1854
        y: 416
      positionAbsolute:
        x: 1854
        y: 416
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "// ä»å¤§æ¨¡å‹è¿”å›ç»“æœä¸­æå–json\nfunction handleLLM(text) {\n  const regex = /```json([\\\
          s\\S]*?)```/\n  const _res = text.replaceAll(/<think>[\\s\\S]*?<\\/think>/g,\
          \ '')\n  const match = _res.match(regex);\n  const res = !!match ? match[1].trim()\
          \ : _res\n  const str = res.replaceAll(/\\/\\/.*$/gm, '').replaceAll(/\\\
          /\\*[\\s\\S]*?\\*\\//g, '')\n  let obj\n  try {\n    obj = JSON.parse(str)\n\
          \  } catch (e) {\n    obj = {}\n  }\n  return obj\n}\nfunction main({text,\
          \ api, token, timezone, query, cache_type, cache_content, other, remote_desktop,\
          \ device_control, filter_device, ota}) {\n  const request = JSON.stringify({\n\
          \    inputs: {\n      content: cache_content,\n      type: cache_type,\n\
          \      question: query,\n      timezone,\n      api,\n      token\n    },\n\
          \    response_mode: 'blocking',\n    user: 'deviceOn'\n  })\n  const obj\
          \ = handleLLM(text)\n  const classify = Number(obj?.classify)\n  let bearer\
          \ = ''\n  switch (classify) {\n    case 1:\n      bearer = 'Bearer ' + device_control\n\
          \      break\n    case 2:\n      bearer = 'Bearer ' + remote_desktop\n \
          \     break\n    case 3:\n      bearer = 'Bearer ' + filter_device\n   \
          \   break\n    case 4:\n      bearer = 'Bearer ' + ota\n      break\n  \
          \  default:\n      bearer = 'Bearer ' + other\n      break\n  }\n  return\
          \ {\n    bearer,\n    classify,\n    request,\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          bearer:
            children: null
            type: string
          classify:
            children: null
            type: number
          request:
            children: null
            type: string
        selected: false
        title: å¤„ç†é—®é¢˜åˆ†ç±»
        type: code
        variables:
        - value_selector:
          - '1744013407466'
          - text
          variable: text
        - value_selector:
          - '1741065173647'
          - api
          variable: api
        - value_selector:
          - '1741065173647'
          - token
          variable: token
        - value_selector:
          - '1741065173647'
          - timezone
          variable: timezone
        - value_selector:
          - sys
          - query
          variable: query
        - value_selector:
          - conversation
          - cache_type
          variable: cache_type
        - value_selector:
          - conversation
          - cache_content
          variable: cache_content
        - value_selector:
          - env
          - other
          variable: other
        - value_selector:
          - env
          - remote_desktop
          variable: remote_desktop
        - value_selector:
          - env
          - device_control
          variable: device_control
        - value_selector:
          - env
          - filter_device
          variable: filter_device
        - value_selector:
          - env
          - ota
          variable: ota
      height: 54
      id: '1744013620630'
      position:
        x: 2158
        y: 408.5
      positionAbsolute:
        x: 2158
        y: 408.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-138
            key: ''
            type: text
            value: '{{#1744013620630.request#}}'
          type: json
        desc: ''
        headers: 'Authorization:{{#1744013620630.bearer#}}

          Content-Type:application/json'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: è¯·æ±‚å·¥ä½œæµ
        type: http-request
        url: '{{#env.path#}}'
        variables: []
      height: 123
      id: '1744019507038'
      position:
        x: 2462
        y: 408.5
      positionAbsolute:
        x: 2462
        y: 408.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "function main({body, classify}) {\n  const obj = JSON.parse(body)\n\
          \  const outputs = obj?.data?.outputs ?? {}\n  return {\n    result: outputs?.result\
          \ ?? '',\n    content: outputs?.content ?? '',\n    type: outputs?.type\
          \ ?? '',\n    need_answer: Number(outputs?.need_answer ?? ([1,2,3,4].includes(classify)\
          \ ? 0 : 1))\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          content:
            children: null
            type: string
          need_answer:
            children: null
            type: number
          result:
            children: null
            type: string
          type:
            children: null
            type: string
        selected: false
        title: å¤„ç†å·¥ä½œæµç»“æœ
        type: code
        variables:
        - value_selector:
          - '1744019507038'
          - body
          variable: body
        - value_selector:
          - '1744013620630'
          - classify
          variable: classify
      height: 54
      id: '1744020229740'
      position:
        x: 2766
        y: 408.5
      positionAbsolute:
        x: 2766
        y: 408.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -1756.999999999999
      y: 87
      zoom: 0.7
