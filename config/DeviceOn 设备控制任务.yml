app:
  description: ''
  icon: ü§ñ
  icon_background: '#FFEAD5'
  mode: workflow
  name: DeviceOn ËÆæÂ§áÊéßÂà∂‰ªªÂä°
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/ollama:0.0.3@9ded90ac00e8510119a24be7396ba77191c9610d5e1e29f59d68fa1229822fc7
kind: app
version: 0.1.5
workflow:
  conversation_variables: []
  environment_variables:
  - description: ''
    id: be2af40d-178f-47b8-bf07-44696040000f
    name: filter_error
    selector:
    - env
    - filter_error
    value: app-akKVIu2IfSDr8rc6jY2rpUww
    value_type: string
  - description: ''
    id: 8c15f414-dd6b-4180-87ca-1512eb5c5c85
    name: add_task
    selector:
    - env
    - add_task
    value: app-qw3E0MI5rY47UbIvqhiM7FCu
    value_type: string
  - description: ''
    id: 411236aa-9c22-4491-9342-0f585fd95f4b
    name: path
    selector:
    - env
    - path
    value: http://172.21.161.126/v1/workflows/run
    value_type: string
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: http-request
      id: 1743557004404-source-1743557128129-target
      source: '1743557004404'
      sourceHandle: source
      target: '1743557128129'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 1743557128129-source-1743557124372-target
      source: '1743557128129'
      sourceHandle: source
      target: '1743557124372'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1743557124372-source-1743557256553-target
      source: '1743557124372'
      sourceHandle: source
      target: '1743557256553'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: 1743557256553-source-1743557392565-target
      source: '1743557256553'
      sourceHandle: source
      target: '1743557392565'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: 1743557392565-source-1743557736373-target
      source: '1743557392565'
      sourceHandle: source
      target: '1743557736373'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: http-request
        targetType: code
      id: 1743557880341-source-1743558167958-target
      source: '1743557880341'
      sourceHandle: source
      target: '1743558167958'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: end
      id: 1743558167958-source-1743558341021-target
      source: '1743558167958'
      sourceHandle: source
      target: '1743558341021'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: http-request
      id: 1743557736373-true-1743557880341-target
      source: '1743557736373'
      sourceHandle: 'true'
      target: '1743557880341'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: end
      id: 1743557736373-false-1743557798587-target
      source: '1743557736373'
      sourceHandle: 'false'
      target: '1743557798587'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: ÂºÄÂßã
        type: start
        variables:
        - label: question
          max_length: 80000
          options: []
          required: true
          type: paragraph
          variable: question
        - label: type
          max_length: 80000
          options: []
          required: true
          type: paragraph
          variable: type
        - label: content
          max_length: 80000
          options: []
          required: true
          type: paragraph
          variable: content
        - label: timezone
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: timezone
        - label: api
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: api
        - label: token
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: token
      height: 220
      id: '1743557004404'
      position:
        x: 30
        y: 310
      positionAbsolute:
        x: 30
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\nfunction convertToTimeZone(timezone) {\n  // Ê£ÄÊü•Ê†ºÂºèÊòØÂê¶‰ª• \"UTC\" ÂºÄÂ§¥\n\
          \  if (!timezone.startsWith(\"UTC\")) {\n    throw new Error(\"Êó∂Âå∫Ê†ºÂºèÂøÖÈ°ª‰ª• 'UTC'\
          \ ÂºÄÂ§¥\");\n  }\n  // Ëé∑ÂèñÁ¨¶Âè∑ÂíåÂ∞èÊó∂„ÄÅÂàÜÈíüÈÉ®ÂàÜ\n  const sign = timezone[3]; // '+' Êàñ '-'\n\
          \  if (sign !== '+' && sign !== '-') {\n    throw new Error(\"Êó†ÊïàÁöÑÊó∂Âå∫Ê†ºÂºè\"\
          );\n  }\n  const hourStr = timezone.substr(4, 2);\n  const minuteStr = timezone.substr(7,\
          \ 2);\n  const offsetHours = parseInt(hourStr, 10);\n  const offsetMinutes\
          \ = parseInt(minuteStr, 10);\n  // ËÆ°ÁÆóÊÄªÂÅèÁßªÂàÜÈíüÊï∞ÔºàÊ≠£ÂÄº‰ª£Ë°®ÊØî UTC ÊôöÔºåË¥üÂÄº‰ª£Ë°®ÊØî UTC Êó©Ôºâ\n \
          \ let totalOffset = offsetHours * 60 + offsetMinutes;\n  if (sign === '-')\
          \ {\n    totalOffset = -totalOffset;\n  }\n  // ÂΩìÂâçÁöÑ UTC ÊØ´ÁßíÊï∞ÔºàDate.now() ËøîÂõûÁöÑÊòØËá™1970Âπ¥1Êúà1Êó•\
          \ UTC ‰ª•Êù•ÁöÑÊØ´ÁßíÊï∞Ôºâ\n  const nowMs = Date.now();\n  // ÁõÆÊ†áÊó∂Âå∫ÁöÑÊØ´ÁßíÊï∞ = ÂΩìÂâç UTC ÊØ´ÁßíÊï∞ +\
          \ Êó∂Âå∫ÂÅèÁßªÂàÜÈíüÊï∞ËΩ¨Êç¢‰∏∫ÊØ´Áßí\n  const targetMs = nowMs + totalOffset * 60000;\n  const\
          \ targetDate = new Date(targetMs);\n  // ‰ΩøÁî® getUTC* ÊñπÊ≥ïÊù•ÊèêÂèñÁõÆÊ†áÊó∂Âå∫ÁöÑÂêÑÈÉ®ÂàÜ\n  const\
          \ year = targetDate.getUTCFullYear();\n  const month = String(targetDate.getUTCMonth()\
          \ + 1).padStart(2, '0'); // Êúà‰ªΩ‰ªé 0 ÂºÄÂßã\n  const day = String(targetDate.getUTCDate()).padStart(2,\
          \ '0');\n  const hours = String(targetDate.getUTCHours()).padStart(2, '0');\n\
          \  const minutes = String(targetDate.getUTCMinutes()).padStart(2, '0');\n\
          \  const seconds = String(targetDate.getUTCSeconds()).padStart(2, '0');\n\
          \n  return `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;\n}\n\
          function main({body, timezone}) {\n  const res = JSON.parse(body)\n  const\
          \ device = Array.isArray(res?.rows) ? Array.from(res.rows).map(o => {\n\
          \    return {\n      id: o.deviceId,\n      nm: o.deviceName,\n      os:\
          \ o.deviceOs,\n      ip: o.deviceIp,\n      l1: o.labelDeviceName1,\n  \
          \    l2: o.labelDeviceName2,\n      st: o.onlineStatus,\n      tz: o.timezone,\n\
          \      hw: o.hardwareError,\n      sw: o.softwareError,\n      bt: o.batteryError,\n\
          \      pp: o.peripheralsError,\n      sc: o.securityError,\n    }\n  })\
          \ : []\n  const id = Array.from(new Set(device.map(o => o.id).filter(o =>\
          \ !!o)))\n  const name = Array.from(new Set(device.map(o => o.nm).filter(o\
          \ => !!o)))\n  const ip = Array.from(new Set(device.map(o => o.ip).filter(o\
          \ => !!o)))\n  const label1 = Array.from(new Set(device.map(o => o.l1).filter(o\
          \ => !!o)))\n  const label2 = Array.from(new Set(device.map(o => o.l2).filter(o\
          \ => !!o)))\n  const date = convertToTimeZone(timezone);\n  return {\n \
          \   device: JSON.stringify(device),\n    id: JSON.stringify(id, null, 2),\n\
          \    name: JSON.stringify(name, null, 2),\n    ip: JSON.stringify(ip, null,\
          \ 2),\n    label1: JSON.stringify(label1, null, 2),\n    label2: JSON.stringify(label2,\
          \ null, 2),\n    date,\n  }\n}\n"
        code_language: javascript
        desc: ''
        outputs:
          date:
            children: null
            type: string
          device:
            children: null
            type: string
          id:
            children: null
            type: string
          ip:
            children: null
            type: string
          label1:
            children: null
            type: string
          label2:
            children: null
            type: string
          name:
            children: null
            type: string
        selected: false
        title: Â§ÑÁêÜËÆæÂ§áÂàóË°®
        type: code
        variables:
        - value_selector:
          - '1743557128129'
          - body
          variable: body
        - value_selector:
          - '1743557004404'
          - timezone
          variable: timezone
      height: 54
      id: '1743557124372'
      position:
        x: 638
        y: 310
      positionAbsolute:
        x: 638
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data: []
          type: none
        desc: ''
        headers: Authorization:{{#1743557004404.token#}}
        method: get
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: Ëé∑ÂèñËÆæÂ§áÂàóË°®
        type: http-request
        url: '{{#1743557004404.api#}}/walle/ai/device/list'
        variables: []
      height: 139
      id: '1743557128129'
      position:
        x: 334
        y: 310
      positionAbsolute:
        x: 334
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1743557004404'
          - question
        desc: ''
        model:
          completion_params:
            num_ctx: 32768
            temperature: 0
          mode: chat
          name: deepseek-r1:14b
          provider: langgenius/ollama/ollama
        prompt_template:
        - id: 632819fc-b0a9-4ecc-8f5c-dbc9087ca078
          role: system
          text: "# ‰ø°ÊÅØÊèêÂèñÊèêÁ§∫ËØç\n\n## `ÈóÆÈ¢ò`: `{{#context#}}`\n\n---\n\n## Â§ÑÁêÜÊµÅÁ®ã\n\n### ‰ªªÂä°Á±ªÂûãÂàÜÊûê\n\
            - Â¶ÇÊûú`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠Âá∫Áé∞ËØ∏Â¶Ç`Ëß¶ÂèëÂûã`„ÄÅ`Ëß¶ÂèëÂûã‰ªªÂä°`Á≠âÁ±ª‰ººÊèèËø∞Êó∂ÂàôËÆæÁΩÆ `is_trigger = true`„ÄÇ\n- **Á§∫‰æãÔºö**\n\
            \    - ÂØπ‰∫éÊñáÊú¨`ËØ∑Êñ∞Â¢û‰∏Ä‰∏™Ëß¶ÂèëÂûã‰ªªÂä°ÔºöÂ∞ÜÂú®Á∫øËÆæÂ§áÈùôÈü≥`ÔºåÁî±‰∫éÂá∫Áé∞‰∫Ü`Ëß¶ÂèëÂûã‰ªªÂä°`ÔºåÂõ†Ê≠§Â∫îËÆæÁΩÆ `is_trigger = true`„ÄÇ\n\
            \n---\n\n### ËÆæÂ§á‰ø°ÊÅØÊèêÂèñ\n\n1. **Âà§Êñ≠ÊòØÂê¶‰ΩøÁî®‰∏ãÊ†áÊåáÂÆöËÆæÂ§áÔºö**\n    - Â¶ÇÊûú`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠Âá∫Áé∞ËØ∏Â¶Ç `Á¨¨‰∏Ä‰∏™`„ÄÅ`Á¨¨‰∫å‰∏™`\
            \ Á≠âÊåá‰ª£‰∏ãÊ†áÁöÑËØçÊó∂ÔºåÂàôËÆæÁΩÆ `assign_index = Áõ∏Â∫îÁöÑÊï∞Â≠ó`„ÄÇ\n    - Â¶ÇÊûú`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠Âá∫Áé∞ËØ∏Â¶Ç `ÊúÄÂêé`„ÄÅ`ÂÄíÊï∞`\
            \ Á≠âÊåá‰ª£ÂèçËΩ¨ÁöÑËØçÊó∂ÔºåÂàôËÆæÁΩÆ `assign_last = true`„ÄÇ\n    - **Á§∫‰æãÔºö**\n        - ÂØπ‰∫éÊñáÊú¨`ËØ∑ËøúÁ®ãËøûÊé•ÂÄíÊï∞Á¨¨‰∫å‰∏™ËÆæÂ§á`ÔºåÁî±‰∫éÂá∫Áé∞`Á¨¨‰∫å‰∏™`Êåá‰ª£‰∏ãÊ†áÔºåÂõ†Ê≠§ËÆæÁΩÆ\
            \ `assign_index = 2`ÔºõÁî±‰∫éÂá∫Áé∞`ÂÄíÊï∞`Ë°®Á§∫ÂèçËΩ¨ÔºåÂõ†Ê≠§ËÆæÁΩÆ `assign_last = true`„ÄÇ\n\n2. **Â≠óÊÆµÊèêÂèñÔºàÊâÄÊúâÂ≠óÊÆµÂùáËøîÂõûÊï∞ÁªÑÔºõËã•Êó†ÂåπÈÖçËøîÂõûÁ©∫Êï∞ÁªÑÔºâÔºö**\n\
            \n    - **IDÂ≠óÊÆµ (`id`)Ôºö**\n        - Âú®`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠**Á≤æÁ°ÆÂåπÈÖç** `{{#1743557124372.id#}}`\
            \ ÂÜÖÁöÑ‰ªª‰∏ÄÂÖÉÁ¥†ÔºåÂ∞ÜÊâÄÊúâÂåπÈÖçÈ°πÂ≠òÂÖ• `id` Â≠óÊÆµ„ÄÇ\n\n    - **ÂêçÁß∞Â≠óÊÆµ (`name`)Ôºö**\n        - Âú®`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠**Á≤æÁ°ÆÂåπÈÖç**\
            \ `{{#1743557124372.name#}}` ÂÜÖÁöÑ‰ªª‰∏ÄÂÖÉÁ¥†ÔºåÂ∞ÜÊâÄÊúâÂåπÈÖçÈ°πÂ≠òÂÖ• `name` Â≠óÊÆµ„ÄÇ\n\n    - **IPÂ≠óÊÆµ\
            \ (`ip`)Ôºö**\n        - Âú®`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠**Á≤æÁ°ÆÂåπÈÖç** `{{#1743557124372.ip#}}` ÂÜÖÁöÑ‰ªª‰∏ÄÂÖÉÁ¥†ÔºåÂ∞ÜÊâÄÊúâÂåπÈÖçÈ°πÂ≠òÂÖ•\
            \ `ip` Â≠óÊÆµ„ÄÇ\n\n    - **Êìç‰ΩúÁ≥ªÁªüÂ≠óÊÆµ (`os`)Ôºö**\n        - Ê£ÄÊü•`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠ÊòØÂê¶ÂåÖÂê´‰∏ãÂàóÂÖ≥ÈîÆËØçÊàñÂÖ∂Âêå‰πâËØçÔºåËã•ÂåπÈÖçÂàôÂ∞ÜÂØπÂ∫îÁöÑÊìç‰ΩúÁ≥ªÁªüÂ≠òÂÖ•\
            \ `os` Â≠óÊÆµÔºö\n            - **windows**ÔºöÂÖ≥ÈîÆËØçÂåÖÊã¨ `windows`„ÄÅ`win`„ÄÅ`ËßÜÁ™ó`Ôºõ\n  \
            \          - **android**ÔºöÂÖ≥ÈîÆËØçÂåÖÊã¨ `android`„ÄÅ`ÂÆâÂçì`Ôºõ\n            - **linux**ÔºöÂÖ≥ÈîÆËØçÂåÖÊã¨\
            \ `linux`„ÄÅ`linuxÁ≥ªÁªü`„ÄÇ\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂÆâÂçìËÆæÂ§áÈùôÈü≥`ÔºåÂàô\
            \ `os` ÊèêÂèñ‰∏∫ `[\"android\"]`„ÄÇ\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜwinËÆæÂ§áÈùôÈü≥`ÔºåÂàô `os` ÊèêÂèñ‰∏∫\
            \ `[\"windows\"]`„ÄÇ\n\n    - **Ê†áÁ≠æ1Â≠óÊÆµ (`label1`)Ôºö**\n        - Âú®`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠**Á≤æÁ°ÆÂåπÈÖç**\
            \ `{{#1743557124372.label1#}}` ÂÜÖÁöÑ‰ªª‰∏ÄÂÖÉÁ¥†ÔºåÂ∞ÜÊâÄÊúâÂåπÈÖçÈ°πÂ≠òÂÖ• `label1` Â≠óÊÆµ„ÄÇ\n\n    - **Ê†áÁ≠æ2Â≠óÊÆµ\
            \ (`label2`)Ôºö**\n        - Âú®`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠**Á≤æÁ°ÆÂåπÈÖç** `{{#1743557124372.label2#}}`\
            \ ÂÜÖÁöÑ‰ªª‰∏ÄÂÖÉÁ¥†ÔºåÂ∞ÜÊâÄÊúâÂåπÈÖçÈ°πÂ≠òÂÖ• `label2` Â≠óÊÆµ„ÄÇ\n\n3. **Êù°‰ª∂Ê†áËÆ∞Ôºö**\n\n   Ê†πÊçÆ`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠ÁöÑÊèèËø∞ËÆæÁΩÆ‰ª•‰∏ãÊ†áËÆ∞Ôºö\n\
            \    - **IDÊ†áËÆ∞ (`assign_id`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `ËÆæÂ§áID‰∏∫...`„ÄÅ`ID‰∏∫...`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_id = true`\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜC4:00:AD:DE:07:76ÂÖ≥Êú∫`ÔºåÂàô\
            \ `assign_id = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜID‰∏∫C4:00:AD:DE:07:76ÁöÑËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô\
            \ `assign_id = true`\n    - **ÂêçÁß∞Ê†áËÆ∞ (`assign_name`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´\
            \ `ËÆæÂ§áÂêçÁß∞‰∏∫...`„ÄÅ`Âêç‰∏∫...` Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_name = true`\n        - **Á§∫‰æãÔºö**\n\
            \            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜPPC-300ÂÖ≥Êú∫`ÔºåÂàô `assign_name = false`\n           \
            \ - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂêç‰∏∫PPC-300ÁöÑËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_name = true`\n    - **IPÊ†áËÆ∞ (`assign_ip`)**:\n\
            \        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `ËÆæÂ§áIP‰∏∫...`„ÄÅ`IP‰∏∫...` Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_ip = true`\n\
            \        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞Ü172.21.73.60ÂÖ≥Êú∫`ÔºåÂàô `assign_ip\
            \ = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜIP‰∏∫172.21.73.60ÁöÑËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_ip =\
            \ true`\n    - **Á≥ªÁªüÊ†áËÆ∞ (`assign_os`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `OS‰∏∫...`„ÄÅ`Á≥ªÁªü‰∏∫...`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_os = true`\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂÆâÂçìËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô\
            \ `assign_os = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÁ≥ªÁªü‰∏∫ÂÆâÂçìÁöÑËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_os =\
            \ true`\n    - **Ê†áÁ≠æ1Ê†áËÆ∞ (`assign_label1`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `Ê†áÁ≠æ1‰∏∫...`„ÄÅ`Ê†áÁ≠æ‰∏∫...`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_label1 = true`\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂ∑•Á®ãËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô\
            \ `assign_label1 = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÊ†áÁ≠æ‰∏∫Â∑•Á®ãËÆæÂ§áÁöÑËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_label1\
            \ = true`\n    - **Ê†áÁ≠æ2Ê†áËÆ∞ (`assign_label2`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `Ê†áÁ≠æ2‰∏∫...`„ÄÅ`Ê†áÁ≠æ‰∏∫...`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_label2 = true`\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜAndroidËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô\
            \ `assign_label2 = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÊ†áÁ≠æ‰∏∫AndroidÁöÑËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_label2\
            \ = true`\n    - **Âú®Á∫øÊ†áËÆ∞ (`assign_online`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `‰∏äÁ∫øÂêéÊâßË°å`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_online = false`\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `Âú®Á∫øËÆæÂ§á`„ÄÅ`Âú®Á∫ø...`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_online = true`\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂÆâÂçìËÆæÂ§áÂÖ≥Êú∫ÔºåËÆæÂ§á‰∏äÁ∫øÂêéÊâßË°å`ÔºåÂàô\
            \ `assign_online = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂú®Á∫øÁöÑÂÆâÂçìËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_online\
            \ = true`\n    - **Á¶ªÁ∫øÊ†áËÆ∞ (`assign_offline`)**:\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `Á¶ªÁ∫øËÆæÂ§á`„ÄÅ`Á¶ªÁ∫ø...`„ÄÅ`Êñ≠Á∫ø‰∏≠...`\
            \ Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_offline = true`\n        - **Á§∫‰æãÔºö**\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÂÆâÂçìËÆæÂ§áÂÖ≥Êú∫ÔºåËÆæÂ§á‰∏äÁ∫øÂêéÊâßË°å`ÔºåÂàô\
            \ `assign_offline = false`\n            - ÂØπ‰∫éÊñáÊú¨`ËØ∑Â∞ÜÁ¶ªÁ∫øÁöÑÂÆâÂçìËÆæÂ§áÂÖ≥Êú∫`ÔºåÂàô `assign_offline\
            \ = true`\n\n4. **ÂºÇÂ∏∏Áä∂ÊÄÅÊ†áËÆ∞Ôºö**\n    - **assign_error**Ôºö\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä\
            \ `ÂºÇÂ∏∏` ‰ΩÜÊú™ÊèêÂèä‰∏ãÂàóÂÖ∑‰ΩìÂºÇÂ∏∏Ôºà`‰∏ä‰∏ãÁ∫øÂºÇÂ∏∏`„ÄÅ`Á°¨‰ª∂ÂºÇÂ∏∏`„ÄÅ`ËΩØ‰ª∂ÂºÇÂ∏∏`„ÄÅ`ÁîµÊ±†ÂºÇÂ∏∏`„ÄÅ`Âë®ËæπËÆæÂ§áÂºÇÂ∏∏`„ÄÅ`ËÆæÂ§áÂÆâÂÖ®ÂºÇÂ∏∏`ÔºâÊó∂ÔºåËÆæÁΩÆ\
            \ `assign_error = true`Ôºõ\n        - ÂΩì`ÈóÆÈ¢ò`‰∏≠ÂåÖÂê´ `Êñ≠Á∫ø‰∏≠` Á≠âÁ±ª‰ººÊèèËø∞Êó∂ ‚Üí `assign_error\
            \ = false`\n    - **assign_up_down**ÔºöÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä `‰∏ä‰∏ãÁ∫øÂºÇÂ∏∏` Êó∂ÔºåËÆæÁΩÆ `assign_up_down\
            \ = true`Ôºõ\n    - **assign_hardware**ÔºöÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä `Á°¨‰ª∂ÂºÇÂ∏∏` Êó∂ÔºåËÆæÁΩÆ `assign_hardware\
            \ = true`Ôºõ\n    - **assign_software**ÔºöÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä `ËΩØ‰ª∂ÂºÇÂ∏∏` Êó∂ÔºåËÆæÁΩÆ `assign_software\
            \ = true`Ôºõ\n    - **assign_battery**ÔºöÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä `ÁîµÊ±†ÂºÇÂ∏∏` Êó∂ÔºåËÆæÁΩÆ `assign_battery\
            \ = true`Ôºõ\n    - **assign_peripheral**ÔºöÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä `Âë®ËæπÂ§ñËÆæÂºÇÂ∏∏` Êó∂ÔºåËÆæÁΩÆ `assign_peripheral\
            \ = true`Ôºõ\n    - **assign_security**ÔºöÂΩì`ÈóÆÈ¢ò`‰∏≠ÊèêÂèä `ËÆæÂ§áÂÆâÂÖ®ÂºÇÂ∏∏` Êó∂ÔºåËÆæÁΩÆ `assign_security\
            \ = true`„ÄÇ\n\n5. **ÂºÇÂ∏∏Êó∂Èó¥Âà§Êñ≠Ôºö**\n    - Â¶ÇÊûú`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠Âá∫Áé∞ËØ∏Â¶Ç`ÂΩìÂâç`„ÄÅ`ÁõÆÂâç`„ÄÅ`ÂΩì‰∏ã`„ÄÅ`Áé∞Âú®`Á≠âË°®Á§∫ÂΩìÂâçÊó∂Èó¥ÁöÑËØçÊó∂ÔºåÂàôËÆæÁΩÆ\
            \ `assign_now = true`„ÄÇ\n    - Â¶ÇÊûú`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠Âá∫Áé∞ËØ∏Â¶Ç`Ëøë‰∏Ä‰∏™Êúà`„ÄÅ`ÊúÄËøë‰∏ÄÂë®`„ÄÅ`Ââç5Â§©`Á≠âË°®Á§∫ÂÖ∑‰ΩìÊó∂Èó¥ÁöÑËØçÊó∂ÔºåËØ∑Ê†πÊçÆÂΩìÂâçÊó∂Èó¥Ôºà`{{#1743557124372.date#}}`ÔºâÔºåËÆ°ÁÆóÂá∫ÂºÄÂßãÊó•ÊúüÂíåÁªìÊùüÊó•ÊúüÔºåÂπ∂ËÆæÁΩÆ\
            \ `start_date = ÂºÄÂßãÊó•ÊúüÔºàÊ†ºÂºèÔºöYYYY/MM/DDÔºâ; end_date = ÁªìÊùüÊó•ÊúüÔºàÊ†ºÂºèÔºöYYYY/MM/DDÔºâ`„ÄÇ\n\
            \    - Â¶ÇÊûú`ÈóÆÈ¢ò`ÊñáÊú¨‰∏≠Ê≤°ÊúâÂá∫Áé∞‰ªª‰ΩïÊåáÊòéÊó∂Èó¥ÁöÑËØçÊó∂ÔºåÂàôËÆæÁΩÆ `assign_time = false`„ÄÇ\n\n---\n\n###\
            \ Êìç‰ΩúÂàÜÊûê\n\n1. **Ê†πÊçÆ`ÈóÆÈ¢ò`ÂÜÖÂÆπÔºåÁ°ÆÂÆöÊìç‰ΩúÁ±ªÂûãÔºö**\n    - **ÈáçÂêØ** ‚Üí `actionCode: 90001`ÔºàÂåπÈÖç`ÈáçÂêØ`„ÄÅ`ÈáçÊñ∞ÂêØÂä®`ÔºâÔºõ\n\
            \    - **ÂÖ≥Êú∫** ‚Üí `actionCode: 90002`ÔºàÂåπÈÖç`ÂÖ≥Êú∫`„ÄÅ`ÂÖ≥Èó≠`ÔºâÔºõ\n    - **Èü≥ÈáèË∞ÉËäÇ** ‚Üí `actionCode:\
            \ 90003`ÔºàÂåπÈÖç`Èü≥ÈáèË∞ÉËäÇ`„ÄÅ`ÈùôÈü≥`„ÄÅ`ÂÖ≥Èó≠Â£∞Èü≥`ÔºåÂêåÊó∂ÊèêÂèñÊìç‰ΩúÊï∞ÂÄºÔºåÊîØÊåÅÁôæÂàÜÊØîÊàñÁ∫ØÊï∞Â≠óÊ†ºÂºèÔºâÔºõ\n    - **‰∫ÆÂ∫¶Ë∞ÉËäÇ** ‚Üí\
            \ `actionCode: 90004`ÔºàÂåπÈÖç`‰∫ÆÂ∫¶Ë∞ÉËäÇ`ÔºåÂêåÊó∂ÊèêÂèñÊìç‰ΩúÊï∞ÂÄºÔºåÊîØÊåÅÁôæÂàÜÊØîÊàñÁ∫ØÊï∞Â≠óÊ†ºÂºèÔºâ„ÄÇ\n\n2. **ÈùôÈü≥Ê£ÄÊµã**\n\
            \    - Ëã•`ÈóÆÈ¢ò`ÊñáÊú¨ÂåÖÂê´`ÈùôÈü≥`„ÄÅ`ÂÖ≥Èó≠Â£∞Èü≥`ÔºåÂàôËÆæÁΩÆ `audioMute: true`ÔºõÂê¶Âàô‰∏∫ `audioMute: false`„ÄÇ\n\
            \n3. **ËØ≠Ë®ÄËÆæÁΩÆ**\n    - Ê†πÊçÆ`ÈóÆÈ¢ò`ÊñáÊú¨ËØ≠Ë®ÄËá™Âä®Á°ÆÂÆö `lang` ÂÄºÔºö\n        - ÁÆÄ‰Ωì‰∏≠Êñá ‚Üí `zh-CN`\n\
            \        - ÁπÅÈ´î‰∏≠Êñá ‚Üí `zh-TW`\n        - Ëã±Êñá ‚Üí `en-US`\n        - Êó•Êñá ‚Üí `ja-JP`\n\
            \n---\n\n### ‰ªªÂä°ÊâßË°åÊó∂Èó¥Â§ÑÁêÜ\n\n1. **‰∏äÁ∫øÂêéÊâßË°å**\n    - Ëã•`ÈóÆÈ¢ò`ÂåÖÂê´ `‰∏äÁ∫øÂêéÊâßË°å`„ÄÅ`ÂèëÂ∏ÉÂêéËøêË°å` Á≠âÁ±ª‰ººÊèèËø∞\
            \ ‚Üí `scheduleType = \"ONLINE\"`\n\n2. **Âª∂ËøüÊâßË°å**\n    - Ëã•`ÈóÆÈ¢ò`ÂåÖÂê´ `XÂàÜÈíüÂêéÊâßË°å`„ÄÅ`ÊåáÂÆöÊó∂Èó¥ÊâßË°å`\
            \ Á≠âÁ±ª‰ººÊòæÂºèÊó∂Èó¥ÊèèËø∞ ‚Üí\n        - `scheduleType = \"CRON ONCE\"`\n        - `scheduleCron\
            \ = ËÆ°ÁÆóÂêéÁöÑÁªùÂØπÊó∂Èó¥ÔºàÊ†ºÂºèÔºöYYYY/MM/DD HH:mm:ssÔºåÂèÇËÄÉÂΩìÂâçÊó∂Èó¥‰∏∫Ôºö{{#1743557124372.date#}}Ôºâ`\n\
            \n3. **Á´ãÂç≥ÊâßË°å/Êó†ÊâßË°åÊó∂Èó¥ÊèèËø∞**\n    - Ëã•`ÈóÆÈ¢ò`ÂåÖÂê´ `Á´ãÂç≥ÊâßË°å` Á≠âÁ±ª‰ººÊèèËø∞Êàñ **Êú™ÊèêÂèäÊâßË°åÊó∂Èó¥** ‚Üí `scheduleType\
            \ = \"NONE\"`\n\n4. **ËÆæÂ§áÊó∂Âå∫ÂÖ≥ËÅî**\n    - Ëã•`ÈóÆÈ¢ò`ÂåÖÂê´ `ËÆæÂ§áÊó∂Èó¥`„ÄÅ`ËÆæÂ§áÊó∂Âå∫` Á≠âÁ±ª‰ººÊèèËø∞ ‚Üí `timezoneLocalEnabled\
            \ = true`\n\n---\n\n## ËæìÂá∫Ê†ºÂºè\nËæìÂá∫ JSON Ê†ºÂºèÂøÖÈ°ªÁ¨¶Âêà‰ª•‰∏ãÁªìÊûÑÔºö\n```json\n{\n  \"actionCode\"\
            : \"<90001 | 90002 | 90003 | 90004ÔºåÂ≠óÁ¨¶‰∏≤>\",\n  \"targetDevices\": {\n \
            \   \"assign_index\": \"<number, ÈªòËÆ§‰∏∫-1>\",\n    \"assign_last\": \"<boolean>\"\
            ,\n    \"id\": \"<Êï∞ÁªÑ>\",\n    \"name\": \"<Êï∞ÁªÑ>\",\n    \"ip\": \"<Êï∞ÁªÑ>\"\
            ,\n    \"os\": \"<Êï∞ÁªÑÔºåwindows | android | linux>\",\n    \"label1\": \"\
            <Êï∞ÁªÑ>\",\n    \"label2\": \"<Êï∞ÁªÑ>\",\n    \"assign_id\": \"<boolean>\",\n\
            \    \"assign_name\": \"<boolean>\",\n    \"assign_ip\": \"<boolean>\"\
            ,\n    \"assign_os\": \"<boolean>\",\n    \"assign_label1\": \"<boolean>\"\
            ,\n    \"assign_label2\": \"<boolean>\",\n    \"assign_online\": \"<boolean>\"\
            ,\n    \"assign_offline\": \"<boolean>\",\n    \"assign_error\": \"<boolean>\"\
            ,\n    \"assign_up_down\": \"<boolean>\",\n    \"assign_hardware\": \"\
            <boolean>\",\n    \"assign_software\": \"<boolean>\",\n    \"assign_battery\"\
            : \"<boolean>\",\n    \"assign_peripheral\": \"<boolean>\",\n    \"assign_security\"\
            : \"<boolean>\",\n    \"assign_now\": \"<boolean>\",\n    \"start_date\"\
            : \"<Êó•ÊúüÂ≠óÁ¨¶‰∏≤ÔºåÊ†ºÂºè YYYY/MM/DD>\",\n    \"end_date\": \"<Êó•ÊúüÂ≠óÁ¨¶‰∏≤ÔºåÊ†ºÂºè YYYY/MM/DD>\"\
            ,\n    \"assign_time\": \"<boolean>\"\n  },\n  \"schedule\": {\n    \"\
            scheduleType\": \"<ONLINE | CRON ONCE | NONE>\",\n    \"scheduleCron\"\
            : \"<Êó∂Èó¥Â≠óÁ¨¶‰∏≤ÔºåÊ†ºÂºè YYYY/MM/DD HH:mm:ss>\",\n    \"timezoneLocalEnabled\": \"\
            <boolean>\"\n  },\n  \"is_trigger\": \"<boolean>\",\n  \"audioMute\":\
            \ \"<boolean>\",\n  \"value\": \"<Êï∞Â≠ó>\",\n  \"lang\": \"<zh-CN | zh-TW\
            \ | ja-JP | en-US>\"\n}\n```\n\n---\n"
        - id: 44fac4a5-8c1a-4b1f-86a7-927a3e9cab86
          role: user
          text: '{{#context#}}'
        selected: false
        title: LLM ËÆæÂ§áÊéßÂà∂‰ªªÂä°ÂèÇÊï∞ÊèêÂèñ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1743557256553'
      position:
        x: 942
        y: 310
      positionAbsolute:
        x: 942
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "/**\n * Â§ÑÁêÜËÆæÂ§áÊéßÂà∂‰ªªÂä°\n */\nfunction handleLLM(text) {\n  const regex =\
          \ /```json([\\s\\S]*?)```/\n  const _res = text.replaceAll(/<think>[\\s\\\
          S]*?<\\/think>/g, '')\n  const match = _res.match(regex);\n  const res =\
          \ !!match ? match[1].trim() : _res\n  const str = res.replaceAll(/\\/\\\
          /.*$/gm, '').replaceAll(/\\/\\*[\\s\\S]*?\\*\\//g, '')\n  let obj\n  try\
          \ {\n    obj = JSON.parse(str)\n  } catch (e) {\n    obj = {}\n  }\n  return\
          \ obj\n}\nfunction main({text, device, type, content, timezone, api, token,\
          \ question, add_task, filter_error}) {\n  device = JSON.parse(device)\n\
          \  const list = Array.isArray(device) ? Array.from(device) : []\n  const\
          \ by_id = {}\n  list.forEach(o => {\n    by_id[o.id] = o\n  })\n  const\
          \ obj = handleLLM(text)\n  const is_trigger = !!obj?.is_trigger\n  const\
          \ assign_index = Number(obj?.targetDevices?.assign_index)\n  const assign_last\
          \ = !!obj?.targetDevices?.assign_last\n  const id = Array.isArray(obj?.targetDevices?.id)\
          \ ? Array.from(obj.targetDevices.id) : []\n  const name = Array.isArray(obj?.targetDevices?.name)\
          \ ? Array.from(obj.targetDevices.name) : []\n  const ip = Array.isArray(obj?.targetDevices?.ip)\
          \ ? Array.from(obj.targetDevices.ip) : []\n  const os = Array.isArray(obj?.targetDevices?.os)\
          \ ? Array.from(obj.targetDevices.os).map(s => String(s).toLowerCase()) :\
          \ []\n  const label1 = Array.isArray(obj?.targetDevices?.label1) ? Array.from(obj.targetDevices.label1)\
          \ : []\n  const label2 = Array.isArray(obj?.targetDevices?.label2) ? Array.from(obj.targetDevices.label2)\
          \ : []\n  const assign_id = !!obj?.targetDevices?.assign_id\n  const assign_name\
          \ = !!obj?.targetDevices?.assign_name\n  const assign_ip = !!obj?.targetDevices?.assign_ip\n\
          \  const assign_os = !!obj?.targetDevices?.assign_os\n  const assign_label1\
          \ = !!obj?.targetDevices?.assign_label1\n  const assign_label2 = !!obj?.targetDevices?.assign_label2\n\
          \  const assign_online = !!obj?.targetDevices?.assign_online\n  const assign_offline\
          \ = !!obj?.targetDevices?.assign_offline\n  const assign_error = !!obj?.targetDevices?.assign_error\n\
          \  const assign_up_down = !!obj?.targetDevices?.assign_up_down\n  const\
          \ assign_hardware = !!obj?.targetDevices?.assign_hardware\n  const assign_software\
          \ = !!obj?.targetDevices?.assign_software\n  const assign_battery = !!obj?.targetDevices?.assign_battery\n\
          \  const assign_peripheral = !!obj?.targetDevices?.assign_peripheral\n \
          \ const assign_security = !!obj?.targetDevices?.assign_security\n  const\
          \ assign_now = !!obj?.targetDevices?.assign_now\n  const assign_time = !!obj?.targetDevices?.assign_time\n\
          \  const start_date = String(obj?.targetDevices?.start_date ?? '')\n  const\
          \ end_date = String(obj?.targetDevices?.end_date ?? '')\n  const lang =\
          \ String(obj?.lang ?? '')\n  const has_error = assign_error || assign_up_down\
          \ || assign_hardware || assign_software || assign_battery || assign_peripheral\
          \ || assign_security\n  const not_prop = id.length === 0 && name.length\
          \ === 0 && ip.length === 0 && os.length === 0 && label1.length === 0 &&\
          \ label2.length === 0\n  const has_prop = assign_id || assign_name || assign_ip\
          \ || assign_os || assign_label1 || assign_label2\n  const actionCode = obj?.actionCode\n\
          \  const find_device = !!content && (type === 'find_device' || type ===\
          \ 'find_error')\n  let result = '', task = '', request = '', bearer = ''\n\
          \  if (!has_error || (has_error && assign_now)) {\n    let filter_id = [],\
          \ filter_device = list.map(o => o)\n    if (find_device) {\n      const\
          \ obj = JSON.parse(content)\n      filter_device = Array.isArray(obj?.data?.targetDevices)\
          \ ? Array.from(obj?.data?.targetDevices).map(o => by_id[o.id]) : []\n  \
          \    if (!Number.isNaN(assign_index) && assign_index > 0 && assign_index\
          \ <= filter_device.length) {\n        let index = assign_index - 1\n   \
          \     if (assign_last) index = filter_device.length - 1 - index\n      \
          \  filter_id = [filter_device[index].id]\n      }\n      if (filter_id.length\
          \ === 0 && not_prop && !has_prop && !assign_online && !assign_offline &&\
          \ !has_error) {\n        filter_id = filter_device.map(o => o.id)\n    \
          \  }\n    }\n    if (filter_id.length === 0) {\n      filter_id = filter_device.filter(o\
          \ => {\n        const match_id = id.includes(o.id)\n        const match_name\
          \ = name.includes(o.nm)\n        const match_ip = ip.includes(o.ip)\n  \
          \      const match_os = os.includes(o.os)\n        const match_label1 =\
          \ label1.includes(o.l1)\n        const match_label2 = label2.includes(o.l2)\n\
          \        const match_online = assign_online && Number(o.st) === 1\n    \
          \    const match_offline = assign_offline && Number(o.st) === 0\n      \
          \  const match_status = match_online || match_offline || (!assign_online\
          \ && !assign_offline)\n        const hardware = Number(o.hw) > 0\n     \
          \   const software = Number(o.sw) > 0\n        const battery = Number(o.bt)\
          \ > 0\n        const peripheral = Number(o.pp) > 0\n        const security\
          \ = Number(o.hw) > 0\n        const match_error = assign_error && (hardware\
          \ || software || battery || peripheral || security)\n        const match_hardware\
          \ = assign_hardware && hardware\n        const match_software = assign_software\
          \ && software\n        const match_battery = assign_battery && battery\n\
          \        const match_peripheral = assign_peripheral && peripheral\n    \
          \    const match_security = assign_security && security\n        let match\
          \ = true\n        // ÂΩìÂè™ÊåáÂÆö‰∫ÜÂºÇÂ∏∏Êó∂ÔºåÂè™Á≠õÈÄâÂºÇÂ∏∏Áõ∏ÂÖ≥\n        if (not_prop && !assign_online\
          \ && !assign_offline && has_error && !assign_up_down) {\n          if (assign_error)\
          \ match = match && match_error\n          if (assign_hardware) match = match\
          \ && match_hardware\n          if (assign_software) match = match && match_software\n\
          \          if (assign_battery) match = match && match_battery\n        \
          \  if (assign_peripheral) match = match && match_peripheral\n          if\
          \ (assign_security) match = match && match_security\n          return match\n\
          \        }\n        // ÂΩìÂè™ÊåáÂÆö‰∫ÜÂú®Á∫øÊàñËÄÖÁ¶ªÁ∫øÊó∂ÔºåÂè™Á≠õÈÄâstatus\n        if (not_prop && (assign_online\
          \ || assign_offline)) {\n          match = match_online || match_offline\n\
          \        }\n        // ÂΩìÊ≤°ÊúâÊåáÂÆöÂÖ∑‰ΩìÊ†è‰ΩçÊó∂ÔºåÂè™Ë¶ÅÊª°Ë∂≥‰∏Ä‰∏™Êù°‰ª∂Â∞±Ë°å\n        else if (!has_prop)\
          \ {\n          match = (match_id || match_name || match_ip || match_os ||\
          \ match_label1 || match_label2) && match_status\n        }\n        // ÂΩìÊúâÊåáÂÆöÂÖ∑‰ΩìÊ†è‰ΩçÊó∂ÔºåÈúÄË¶ÅÊª°Ë∂≥ÊâÄÊúâÊåáÂÆöÊ†è‰Ωç\n\
          \        else {\n          match = match && match_status\n          if (assign_id)\
          \ match = match && match_id\n          if (assign_name) match = match &&\
          \ match_name\n          if (assign_ip) match = match && match_ip\n     \
          \     if (assign_os) match = match && match_os\n          if (assign_label1\
          \ && !assign_label2) match = match && match_label1\n          if (!assign_label1\
          \ && assign_label2) match = match && match_label2\n          if (assign_label1\
          \ && assign_label2) match = match && (match_label2 || match_label1)\n  \
          \      }\n        if (assign_error) match = match && match_error\n     \
          \   if (assign_hardware) match = match && match_hardware\n        if (assign_software)\
          \ match = match && match_software\n        if (assign_battery) match = match\
          \ && match_battery\n        if (assign_peripheral) match = match && match_peripheral\n\
          \        if (assign_security) match = match && match_security\n        return\
          \ match\n      }).map(o => o.id)\n    }\n    const filter = filter_id.map(id\
          \ => {\n      const o = by_id[id]\n      return {\n        id: o.id,\n \
          \       name: o.nm,\n        os: o.os,\n        timezone: o.tz,\n      }\n\
          \    })\n    result = JSON.stringify({\n      type: is_trigger ? 'trigger_task'\
          \ : 'control_task',\n      data: {\n        ...obj,\n        targetDevices:\
          \ filter,\n      },\n    })\n    task = filter.length > 0 ? 'control_task'\
          \ : ''\n    if (actionCode === '90001' && !is_trigger && find_device &&\
          \ filter.length === 1 && filter_device.length === 1) {\n      request =\
          \ JSON.stringify({\n        inputs: {\n          content: result,\n    \
          \      timezone,\n          api,\n          token\n        },\n        response_mode:\
          \ 'blocking',\n        user: 'deviceOn device_control'\n      })\n     \
          \ bearer = 'Bearer ' + add_task\n    }\n  } else {\n    let sd = new Date(start_date)\n\
          \    let ed = new Date(end_date)\n    if (!assign_time) {\n      ed = new\
          \ Date()\n      ed.setHours(0, 0, 0, 0)\n      const day = ed.getDate()\n\
          \      let month = ed.getMonth() - 3\n      let year = ed.getFullYear()\n\
          \      if (month < 0) {\n        month += 12\n        year -= 1\n      }\n\
          \      const last = new Date(year, month + 1, 0).getDate()\n      const\
          \ date = Math.min(day, last)\n      sd = new Date(year, month, date)\n \
          \   }\n    const start = sd.getTime()\n    const end = ed.getTime() + (24\
          \ * 60 * 60 * 1000 - 1)\n    let range = [], params = ''\n    if (assign_up_down)\
          \ range = range.concat('4')\n    if (assign_hardware) range = range.concat('1')\n\
          \    if (assign_software) range = range.concat('2')\n    if (assign_battery)\
          \ range = range.concat('6')\n    if (assign_peripheral) range = range.concat('3')\n\
          \    if (assign_security) range = range.concat('7')\n    params = `?startTime=${start}&endTime=${end}`\n\
          \    range.forEach(item => {\n      params += `&categoryRange=${item}`\n\
          \    })\n    request = JSON.stringify({\n      inputs: {\n        params,\n\
          \        range: JSON.stringify(range),\n        lang,\n        device: JSON.stringify(device),\n\
          \        question,\n        api,\n        token\n      },\n      response_mode:\
          \ 'blocking',\n      user: 'deviceOn device_control'\n    })\n    bearer\
          \ = 'Bearer ' + filter_error\n    result = JSON.stringify({\n      type:\
          \ is_trigger ? 'trigger_task' : 'control_task',\n      data: {\n       \
          \ ...obj,\n        targetDevices: [],\n      },\n    })\n  }\n\n  return\
          \ {\n    result,\n    content: !!task ? result : '',\n    type: task,\n\
          \    device: obj,\n    request,\n    bearer,\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          bearer:
            children: null
            type: string
          content:
            children: null
            type: string
          device:
            children: null
            type: object
          request:
            children: null
            type: string
          result:
            children: null
            type: string
          type:
            children: null
            type: string
        selected: false
        title: Â§ÑÁêÜËÆæÂ§áÊéßÂà∂‰ªªÂä°
        type: code
        variables:
        - value_selector:
          - '1743557256553'
          - text
          variable: text
        - value_selector:
          - '1743557124372'
          - device
          variable: device
        - value_selector:
          - '1743557004404'
          - type
          variable: type
        - value_selector:
          - '1743557004404'
          - content
          variable: content
        - value_selector:
          - '1743557004404'
          - timezone
          variable: timezone
        - value_selector:
          - '1743557004404'
          - api
          variable: api
        - value_selector:
          - '1743557004404'
          - token
          variable: token
        - value_selector:
          - '1743557004404'
          - question
          variable: question
        - value_selector:
          - env
          - add_task
          variable: add_task
        - value_selector:
          - env
          - filter_error
          variable: filter_error
      height: 54
      id: '1743557392565'
      position:
        x: 1246
        y: 310
      positionAbsolute:
        x: 1246
        y: 310
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not empty
            id: fda0e3ca-fd2b-4ab0-9efd-12f90cf76051
            value: ''
            varType: string
            variable_selector:
            - '1743557392565'
            - bearer
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÊâßË°åÂ∑•‰ΩúÊµÅ
        type: if-else
      height: 126
      id: '1743557736373'
      position:
        x: 1550
        y: 310
      positionAbsolute:
        x: 1550
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1743557392565'
          - result
          variable: result
        - value_selector:
          - '1743557392565'
          - content
          variable: content
        - value_selector:
          - '1743557392565'
          - type
          variable: type
        selected: false
        title: ËøîÂõûÊï∞ÊçÆ
        type: end
      height: 142
      id: '1743557798587'
      position:
        x: 1854
        y: 310
      positionAbsolute:
        x: 1854
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-53
            key: ''
            type: text
            value: '{{#1743557392565.request#}}'
          type: json
        desc: ''
        headers: 'Authorization:{{#1743557392565.bearer#}}

          Content-Type:application/json'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: ËØ∑Ê±ÇÂ∑•‰ΩúÊµÅ
        type: http-request
        url: '{{#env.path#}}'
        variables: []
      height: 123
      id: '1743557880341'
      position:
        x: 1854
        y: 492
      positionAbsolute:
        x: 1854
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "/**\n * Â§ÑÁêÜÂ∑•‰ΩúÊµÅÁªìÊûú\n */\nfunction main({body, filter_error, bearer, result})\
          \ {\n  const obj = JSON.parse(body)\n  const outputs = obj?.data?.outputs\
          \ ?? {}\n  if (bearer === `Bearer ${filter_error}`) {\n    const res = JSON.parse(outputs?.result\
          \ ?? '{}')\n    const device = Array.isArray(res?.data?.targetDevices) ?\
          \ Array.from(res.data.targetDevices) : []\n    const obj = JSON.parse(result)\n\
          \    const task = JSON.stringify({\n      ...obj,\n      data: {\n     \
          \   ...obj.data,\n        targetDevices: device,\n      }\n    })\n    return\
          \ {\n      result: task,\n      content: device.length > 0 ? task : '',\n\
          \      type: device.length > 0 ? 'control_task' : '',\n    }\n  }\n  return\
          \ {\n    result: outputs?.result ?? '',\n    content: outputs?.content ??\
          \ '',\n    type: outputs?.type ?? ''\n  }\n}"
        code_language: javascript
        desc: ''
        outputs:
          content:
            children: null
            type: string
          result:
            children: null
            type: string
          type:
            children: null
            type: string
        selected: false
        title: Â§ÑÁêÜÂ∑•‰ΩúÊµÅÁªìÊûú
        type: code
        variables:
        - value_selector:
          - '1743557880341'
          - body
          variable: body
        - value_selector:
          - env
          - filter_error
          variable: filter_error
        - value_selector:
          - '1743557392565'
          - bearer
          variable: bearer
        - value_selector:
          - '1743557392565'
          - result
          variable: result
      height: 54
      id: '1743558167958'
      position:
        x: 2158
        y: 482.5
      positionAbsolute:
        x: 2158
        y: 482.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1743558167958'
          - result
          variable: result
        - value_selector:
          - '1743558167958'
          - content
          variable: content
        - value_selector:
          - '1743558167958'
          - type
          variable: type
        selected: false
        title: ËøîÂõûÊï∞ÊçÆ
        type: end
      height: 142
      id: '1743558341021'
      position:
        x: 2462
        y: 482.5
      positionAbsolute:
        x: 2462
        y: 482.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -609.0000000000007
      y: 64.99999999999966
      zoom: 0.7
